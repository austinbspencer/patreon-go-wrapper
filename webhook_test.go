package patreon

import (
	"testing"

	"github.com/stretchr/testify/require"
)

const (
	webhookSecret       = "VOOskLxZ_AVczRZaHVZSth4i5mCR8QAvWXlGkp75V7Yz1Zs5rvAfrdB0SXcItR-j"
	pledgeCreateMessage = `{"data":{"attributes":{"amount_cents":150,"created_at":"2015-05-18T23:50:42+00:00","declined_since":null,"patron_pays_fees":false,"pledge_cap_cents":null},"id":"1","relationships":{"address":{"data":null},"card":{"data":null},"creator":{"data":{"id":"4221587","type":"user"},"links":{"related":"https://www.patreon.com/api/user/4221587"}},"patron":{"data":{"id":"4221587","type":"user"},"links":{"related":"https://www.patreon.com/api/user/4221587"}},"reward":{"data":{"id":"1146941","type":"reward"},"links":{"related":"https://www.patreon.com/api/rewards/1146941"}}},"type":"pledge"},"included":[{"attributes":{"about":"","created":"2016-10-12T22:25:50+00:00","discord_id":null,"email":"pavlenko.maksym+gdevs@gmail.com","facebook":null,"facebook_id":null,"first_name":"\u0410\u0434\u043c\u0438\u043d\u044b","full_name":"\u0410\u0434\u043c\u0438\u043d\u044b","gender":0,"has_password":true,"image_url":"https://c10.patreonusercontent.com/3/eyJ3Ijo0MDB9/patreon-user/zwGAxCnLnTmAc8RXATRlPECxuc8KcflDnODNm1Dmfh7GMGTnGu97VQSMYNTXmHBh_large_2.jpeg?token-time=2145916800&token-hash=9oGzc1SvW9vt-DUxmK6F6xc7gPrvSiCvSirq9yzvITE%3D","is_deleted":false,"is_email_verified":true,"is_nuked":false,"is_suspended":false,"last_name":"","social_connections":{"deviantart":null,"discord":null,"facebook":null,"spotify":null,"twitch":null,"twitter":null,"youtube":null},"thumb_url":"https://c10.patreonusercontent.com/3/eyJoIjoxMDAsInciOjEwMH0%3D/patreon-user/zwGAxCnLnTmAc8RXATRlPECxuc8KcflDnODNm1Dmfh7GMGTnGu97VQSMYNTXmHBh_large_2.jpeg?token-time=2145916800&token-hash=0vEOeBSfAy_UH46W7J4Xj0TK9PH7rML-tQB3DW1R2vU%3D","twitch":null,"twitter":null,"url":"https://www.patreon.com/gdevs","vanity":"gdevs","youtube":"https://www.youtube.com/channel/UCOITs5TWBjRE3d36pfuaB8Q"},"id":"4221587","relationships":{"campaign":{"data":{"id":"563771","type":"campaign"},"links":{"related":"https://www.patreon.com/api/campaigns/563771"}}},"type":"user"},{"attributes":{"amount":100,"amount_cents":100,"created_at":"2016-12-10T00:47:34.171102+00:00","description":"<div>\u0420\u0430\u043d\u043d\u0438\u0439 \u0434\u043e\u0441\u0442\u0443\u043f \u043a \u0443\u043d\u0438\u043a\u0430\u043b\u044c\u043d\u043e\u043c\u0443 \u043a\u043e\u043d\u0442\u0435\u043d\u0442\u0443 \u0433\u0440\u0443\u043f\u043f\u044b.</div>","discord_role_ids":null,"edited_at":"2016-12-10T00:47:34.171102+00:00","image_url":"","patron_count":0,"post_count":null,"published":true,"published_at":"2016-12-10T00:47:34.171102+00:00","remaining":null,"requires_shipping":false,"title":"Early Access","unpublished_at":null,"url":"/bePatron?c=563771&rid=1146941","user_limit":null},"id":"1146941","relationships":{"campaign":{"data":{"id":"563771","type":"campaign"},"links":{"related":"https://www.patreon.com/api/campaigns/563771"}},"creator":{"data":{"id":"4221587","type":"user"},"links":{"related":"https://www.patreon.com/api/user/4221587"}}},"type":"reward"},{"attributes":{"created_at":"2016-10-12T22:26:31+00:00","creation_count":1,"creation_name":"\u0418\u0433\u0440\u043e\u0432\u0430\u044f \u0432\u0441\u0435\u043b\u0435\u043d\u043d\u0430\u044f | Gamedev","discord_server_id":null,"display_patron_goals":false,"earnings_visibility":"public","image_small_url":"https://c10.patreonusercontent.com/3/eyJoIjoxMjgwLCJ3IjoxMjgwfQ%3D%3D/patreon-user/v4PyaYQNb7N1QxsmObIm50mntOTGCOhLOalAyc5tE7ZGYm558j3FJCA2LyYH5uOY_large_2.png?token-time=2145916800&token-hash=cNuFyxHj2bkG49OEGxY1ZstusiM74oofEcPjzCB83Y8%3D","image_url":"https://c10.patreonusercontent.com/3/eyJ3IjoxOTIwfQ%3D%3D/patreon-user/v4PyaYQNb7N1QxsmObIm50mntOTGCOhLOalAyc5tE7ZGYm558j3FJCA2LyYH5uOY_large_2.png?token-time=2145916800&token-hash=YfW8vwu2RpyP6co40kO3HyKleqMlyumn5aLf9bdci3c%3D","is_charged_immediately":false,"is_monthly":true,"is_nsfw":false,"is_plural":true,"main_video_embed":null,"main_video_url":null,"one_liner":null,"outstanding_payment_amount_cents":0,"patron_count":0,"pay_per_name":"month","pledge_sum":0,"pledge_url":"/bePatron?c=563771","published_at":"2016-11-07T16:49:18+00:00","summary":"\u0427\u0442\u043e \u0431\u0443\u0434\u0435\u0442, \u0435\u0441\u043b\u0438 \u0441\u043e\u0431\u0440\u0430\u0442\u044c \u0432\u0441\u0435\u0445 \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u0447\u0438\u043a\u043e\u0432 \u0438\u0433\u0440 \u0432 \u043e\u0434\u043d\u043e\u043c \u043c\u0435\u0441\u0442\u0435? \u041e\u043d\u0438 \u0441\u043e\u0437\u0434\u0430\u0434\u0443\u0442 \u0441\u0432\u043e\u044e \u0418\u0433\u0440\u043e\u0432\u0443\u044e \u0412\u0441\u0435\u043b\u0435\u043d\u043d\u0443\u044e, \u043e\u043d\u0438 \u0441\u043e\u0437\u0434\u0430\u0434\u0443\u0442 \u0443\u043d\u0438\u043a\u0430\u043b\u044c\u043d\u044b\u0435 \u0438\u0433\u0440\u044b. \u0418\u0433\u0440\u044b, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043d\u0435 \u043c\u043e\u0433\u043b\u0438 \u0431\u044b \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043f\u043e\u043e\u0434\u0438\u043d\u043e\u0447\u043a\u0435 \u0438\u043b\u0438 \u0432 \u0441\u0432\u043e\u0438\u0445 \u043d\u0435\u0431\u043e\u043b\u044c\u0448\u0438\u0445 \u0441\u0442\u0443\u0434\u0438\u044f\u0445.<br><br><a href=\"https://vk.com/gdevs\" rel=\"nofollow\">\u041d\u0430\u0448 \u043f\u0440\u043e\u0435\u043a\u0442</a> \u043f\u0440\u0438\u0437\u0432\u0430\u043d \u0441\u043e\u0431\u0440\u0430\u0442\u044c \u0432 \u043e\u0434\u043d\u043e\u043c \u043c\u0435\u0441\u0442\u0435 \u0432\u0441\u0435\u0445 \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u0447\u0438\u043a\u043e\u0432: \u0438 \u0442\u0435\u0445, \u043a\u0442\u043e \u0443\u0436\u0435 \u0437\u0430\u043d\u0438\u043c\u0430\u0435\u0442\u0441\u044f \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u043a\u043e\u0439 \u0438\u0433\u0440, \u0438 \u0442\u0435\u0445 \u043a\u0442\u043e, \u043b\u0438\u0448\u044c \u0438\u043c\u0435\u0435\u0442 \u0436\u0435\u043b\u0430\u043d\u0438\u0435 \u043d\u0430\u0447\u0430\u0442\u044c. \u041c\u044b \u0443\u0436\u0435 \u0441\u043e\u0431\u0440\u0430\u043b\u0438 \u0432 \u043e\u0434\u043d\u043e\u043c \u043c\u0435\u0441\u0442\u0435 \u0442\u0440\u0435\u0442\u044c \u0432\u0441\u0435\u0445 \u043b\u044e\u0434\u0435\u0439 \u0432 \u0421\u041d\u0413, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0443\u0432\u043b\u0435\u043a\u0430\u044e\u0442\u0441\u044f \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u043a\u043e\u0439. \u041c\u044b \u0443\u0436\u0435 \u043d\u0430\u043f\u043e\u043b\u043d\u0438\u043b\u0438 \u0441\u043e\u043e\u0431\u0449\u0435\u0441\u0442\u0432\u043e \u043a\u0440\u0443\u043f\u043d\u0435\u0439\u0448\u0435\u0439 \u0431\u0430\u0437\u043e\u0439 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438 \u043f\u043e \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u043a\u0435 \u0438\u0433\u0440 \u043d\u0430 \u0440\u0443\u0441\u0441\u043a\u043e\u043c \u044f\u0437\u044b\u043a\u0435. \u0421 \u043d\u0430\u043c\u0438 \u0443\u0436\u0435 \u0441\u043e\u0442\u0440\u0443\u0434\u043d\u0438\u0447\u0430\u044e\u0442 \u0442\u0430\u043a\u0438\u0435 \u043a\u043e\u043c\u043f\u0430\u043d\u0438\u0438 \u043a\u0430\u043a Microsoft \u0438 \u0438\u0437\u0434\u0430\u0442\u0435\u043b\u044c\u0441\u0442\u0432\u043e \u0438\u0433\u0440 \u0411\u0443\u043a\u0430. \u0422\u0435\u043f\u0435\u0440\u044c \u043f\u0435\u0440\u0435\u0434 \u043d\u0430\u043c\u0438 \u0441\u0442\u043e\u044f\u0442 \u043d\u043e\u0432\u044b\u0435 \u0446\u0435\u043b\u0438, \u043c\u044b \u0433\u043e\u0442\u043e\u0432\u044b \u043a \u043d\u043e\u0432\u044b\u043c \u0441\u0432\u0435\u0440\u0448\u0435\u043d\u0438\u044f\u043c! <br><br><img src=\"https://pp.vk.me/c626922/v626922786/32d58/AiEm0_XHQbs.jpg\"><br><br>\u0410\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f \u043d\u0430\u0448\u0435\u0433\u043e \u0440\u0435\u0441\u0443\u0440\u0441\u0430 \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442 \u0434\u043d\u0435\u043c \u0438 \u043d\u043e\u0447\u044c\u044e \u043d\u0430\u0434 \u0435\u0433\u043e \u043d\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435\u043c \u0438 \u0440\u0430\u0437\u0432\u0438\u0442\u0438\u0435\u043c. \u041c\u044b \u0442\u0440\u0430\u0442\u0438\u043c \u0441\u0432\u043e\u0438 \u0441\u043e\u0431\u0441\u0442\u0432\u0435\u043d\u043d\u044b\u0435 \u0432\u0440\u0435\u043c\u044f, \u0441\u0438\u043b\u044b \u0438 \u0434\u0435\u043d\u044c\u0433\u0438 \u043d\u0430 \u0442\u043e, \u0447\u0442\u043e\u0431 \u0434\u043e\u043d\u0435\u0441\u0442\u0438 \u043c\u0430\u043a\u0441\u0438\u043c\u0443\u043c \u043f\u043e\u043b\u0435\u0437\u043d\u043e\u0439 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438 \u0434\u043e \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u0430 \u0437\u0430\u0438\u043d\u0442\u0435\u0440\u0435\u0441\u043e\u0432\u0430\u043d\u043d\u044b\u0445 \u043b\u044e\u0434\u0435\u0439!<br><br><img src=\"https://pp.vk.me/c626922/v626922786/32d4e/NwLUm4gIwCo.jpg\"><br><br>\u0414\u043b\u044f \u0442\u043e\u0433\u043e \u0447\u0442\u043e \u0431\u044b \u0441\u0442\u0430\u0442\u044c \u043b\u0443\u0447\u0448\u0435 \u0438 \u0434\u0435\u043b\u0430\u0442\u044c \u0431\u043e\u043b\u044c\u0448\u0435, \u043d\u0430\u043c \u043d\u0443\u0436\u043d\u0430 \u0412\u0430\u0448\u0430 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0430! \u041c\u044b \u0441\u043c\u043e\u0436\u0435\u043c \u0432\u044b\u0434\u0435\u043b\u044f\u0442\u044c \u0431\u043e\u043b\u044c\u0448\u0435 \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432 \u043d\u0430 \u043f\u0440\u043e\u0434\u0432\u0438\u0436\u0435\u043d\u0438\u0435, \u043f\u043e\u043b\u0443\u0447\u0430\u0442\u044c \u0431\u043e\u043b\u044c\u0448\u0435 \u043f\u043e\u043b\u0435\u0437\u043d\u044b\u0445 \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432, \u043f\u0440\u0438\u0432\u043b\u0435\u043a\u0430\u0442\u044c \u043a \u0440\u0430\u0431\u043e\u0442\u0435 \u0441\u043f\u0435\u0446\u0438\u0430\u043b\u0438\u0441\u0442\u043e\u0432 \u0432 \u0441\u0444\u0435\u0440\u0435 \u0433\u0435\u0439\u043c-\u0434\u0438\u0437\u0430\u0439\u043d\u0430 \u0438 \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0431\u0443\u0434\u0443\u0442 \u043d\u0430\u0441\u0442\u0430\u0432\u043b\u044f\u0442\u044c \u043d\u0430\u0448\u0438\u0445 \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u043e\u0432, \u0434\u0430\u0432\u0430\u0442\u044c \u043f\u043e\u0441\u0438\u043b\u044c\u043d\u0443\u044e \u043f\u043e\u043c\u043e\u0449\u044c \u0432 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0438 \u043f\u0440\u043e\u0435\u043a\u0442\u043e\u0432 \u0438 \u0434\u0435\u043b\u0438\u0442\u044c\u0441\u044f \u0441\u0432\u043e\u0438\u043c\u0438 \u0437\u043d\u0430\u043d\u0438\u044f\u043c\u0438. <br><br>\u0412\u044b \u043d\u0443\u0436\u043d\u044b \u043d\u0430\u043c, \u0432\u044b \u043d\u0443\u0436\u043d\u044b \u0418\u0433\u0440\u043e\u0432\u043e\u0439 \u0412\u0441\u0435\u043b\u0435\u043d\u043d\u043e\u0439! <br>","thanks_embed":"","thanks_msg":null,"thanks_video_url":null},"id":"563771","relationships":{"creator":{"data":{"id":"4221587","type":"user"},"links":{"related":"https://www.patreon.com/api/user/4221587"}},"goals":{"data":[{"id":"603656","type":"goal"},{"id":"603665","type":"goal"},{"id":"603668","type":"goal"},{"id":"603671","type":"goal"},{"id":"605051","type":"goal"},{"id":"605091","type":"goal"}]},"rewards":{"data":[{"id":"-1","type":"reward"},{"id":"0","type":"reward"},{"id":"1146941","type":"reward"}]}},"type":"campaign"},{"attributes":{"amount":0,"amount_cents":0,"created_at":null,"description":"Everyone","remaining":0,"requires_shipping":false,"url":null,"user_limit":null},"id":"-1","relationships":{"creator":{"data":{"id":"4221587","type":"user"},"links":{"related":"https://www.patreon.com/api/user/4221587"}}},"type":"reward"},{"attributes":{"amount":1,"amount_cents":1,"created_at":null,"description":"Patrons Only","remaining":0,"requires_shipping":false,"url":null,"user_limit":null},"id":"0","relationships":{"creator":{"data":{"id":"4221587","type":"user"},"links":{"related":"https://www.patreon.com/api/user/4221587"}}},"type":"reward"},{"attributes":{"amount_cents":20000,"completed_percentage":0,"created_at":"2016-11-06T18:01:56+00:00","description":"\u041c\u044b \u0433\u0435\u043d\u0435\u0440\u0438\u0440\u0443\u0435\u043c \u0431\u043e\u043b\u044c\u0448\u0435 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435\u043d\u043d\u044b\u0445 \u043c\u0430\u0442\u0435\u0440\u0438\u0430\u043b\u043e\u0432 \u0438 \u0443\u0440\u043e\u043a\u043e\u0432 \u0434\u043b\u044f \u0447\u0438\u0442\u0430\u0442\u0435\u043b\u0435\u0439 (\u0443\u0432\u0435\u043b\u0438\u0447\u0438\u0432\u0430\u0435\u043c \u0430\u0432\u0442\u043e\u0440\u0441\u043a\u0438\u0439 \u0441\u043e\u0441\u0442\u0430\u0432, \u043d\u0435 \u0441\u043f\u0438\u043c \u043d\u043e\u0447\u0430\u043c\u0438, \u043f\u044c\u0435\u043c \u044d\u043d\u0435\u0440\u0433\u0435\u0442\u0438\u043a\u0438).","reached_at":null,"title":""},"id":"603656","type":"goal"},{"attributes":{"amount_cents":60000,"completed_percentage":0,"created_at":"2016-11-06T18:12:34+00:00","description":"\u041c\u044b \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0435\u043c \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u0443 \u043e\u0442\u043a\u0440\u044b\u0442\u044b\u0445 \u0432\u0438\u0434\u0435\u043e-\u043a\u0443\u0440\u0441\u043e\u0432 \u043f\u043e \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044e \u0438\u0433\u0440 \u043e\u0442 \u0410 \u0434\u043e \u042f.<br>","reached_at":null,"title":""},"id":"603665","type":"goal"},{"attributes":{"amount_cents":40000,"completed_percentage":0,"created_at":"2016-11-06T18:13:50+00:00","description":"\u041c\u044b \u0441\u043e\u0431\u0438\u0440\u0430\u0435\u043c \u0438 \u0433\u043e\u0442\u043e\u0432\u0438\u043c \u043a \u043f\u0435\u0440\u0435\u0432\u043e\u0434\u0443 \u0434\u0435\u0441\u044f\u0442\u043a\u0438 \u043c\u0430\u0442\u0435\u0440\u0438\u0430\u043b\u043e\u0432 \u0441 \u0438\u043d\u043e\u0441\u0442\u0440\u0430\u043d\u043d\u044b\u0445 \u044f\u0437\u044b\u043a\u043e\u0432, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0440\u0430\u043d\u0435\u0435 \u043d\u0435 \u0431\u044b\u043b\u0438 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u0447\u0438\u043a\u0430\u043c \u0432 \u0421\u041d\u0413. <br>","reached_at":null,"title":""},"id":"603668","type":"goal"},{"attributes":{"amount_cents":100000,"completed_percentage":0,"created_at":"2016-11-06T18:16:13+00:00","description":"\u041c\u043d\u043e\u0433\u043e \u043e\u0442\u043b\u0438\u0447\u043d\u044b\u0445 \u0441\u0442\u0430\u0442\u0435\u0439 \u0443\u0445\u043e\u0434\u044f\u0442 \u0432\u043d\u0438\u0437 \u0432 \u043b\u0435\u043d\u0442\u0435 \u043f\u0430\u0431\u043b\u0438\u043a\u0430 \u0438 \u0442\u0435\u0440\u044f\u044e\u0442\u0441\u044f. \u041c\u044b \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0435\u043c \u0441\u0432\u043e\u0439 \u043f\u043e\u043b\u043d\u043e\u0446\u0435\u043d\u043d\u044b\u0439 \u0441\u0430\u0439\u0442 - \u0430\u0440\u0445\u0438\u0432 \u0442\u043e\u043f\u043e\u0432\u044b\u0445 \u043f\u0443\u0431\u043b\u0438\u043a\u0430\u0446\u0438\u0439. \u0421\u0442\u0430\u0442\u044c\u0438 \u043e\u0442\u0444\u043e\u0440\u043c\u0430\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u044b \u0434\u043b\u044f \u0447\u0442\u0435\u043d\u0438\u044f (\u0431\u0435\u0437 \u043c\u0443\u0441\u043e\u0440\u0430, \u0448\u0430\u043f\u043e\u043a, \u0440\u0435\u043a\u043b\u0430\u043c\u044b \u0438 \u0442. \u0434.), \u043f\u043e\u043c\u0435\u0447\u0435\u043d\u044b \u0442\u0435\u0433\u0430\u043c\u0438 \u0438 \u0441 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u044c\u044e \u043f\u043e\u043b\u043d\u043e\u0442\u0435\u043a\u0441\u0442\u043e\u0432\u043e\u0433\u043e \u043f\u043e\u0438\u0441\u043a\u0430. \u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u043c\u043e\u0436\u0435\u0442 \u0441\u0444\u043e\u0440\u043c\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0441\u0432\u043e\u0439 \u0430\u0440\u0445\u0438\u0432 \u0437\u0430\u043a\u043b\u0430\u0434\u043e\u043a.","reached_at":null,"title":""},"id":"603671","type":"goal"},{"attributes":{"amount_cents":30000,"completed_percentage":0,"created_at":"2016-11-08T03:47:56+00:00","description":"\u041f\u0440\u0438\u043d\u0438\u043c\u0430\u0435\u043c \u0434\u043e\u043f\u0438\u043d\u0433 \u0438 \u0443\u0432\u0435\u043b\u0438\u0447\u0438\u0432\u0430\u0435\u043c \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043f\u0443\u0431\u043b\u0438\u043a\u0430\u0446\u0438\u0439 \u0441 10 \u0434\u043e 15.","reached_at":null,"title":""},"id":"605051","type":"goal"},{"attributes":{"amount_cents":200000,"completed_percentage":0,"created_at":"2016-11-08T04:31:45+00:00","description":"\u041f\u0440\u043e\u0432\u043e\u0434\u0438\u043c \u0441\u043e\u0431\u0441\u0442\u0432\u0435\u043d\u043d\u044b\u0435 \u043c\u0435\u0440\u043e\u043f\u0440\u0438\u044f\u0442\u0438\u044f \u0434\u043b\u044f \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u0447\u0438\u043a\u043e\u0432 \u0438\u0433\u0440 \u0432 \u0440\u0430\u0437\u043d\u044b\u0445 \u0433\u043e\u0440\u043e\u0434\u0430\u0445 \u0420\u043e\u0441\u0441\u0438\u0438, \u0423\u043a\u0440\u0430\u0438\u043d\u044b \u0438\u00a0\u0411\u0435\u043b\u0430\u0440\u0443\u0441\u0438. \u0422\u0435\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u0435 \u0432\u0441\u0442\u0440\u0435\u0447\u0438 \u0434\u043b\u044f \u0437\u043d\u0430\u043a\u043e\u043c\u0441\u0442\u0432, \u043e\u0431\u0449\u0435\u043d\u0438\u044f, \u043f\u043e\u043b\u0435\u0437\u043d\u044b\u0445 \u043a\u043e\u043d\u0442\u0430\u043a\u0442\u043e\u0432 \u0438 \u043e\u0431\u043c\u0435\u043d\u0430 \u043e\u043f\u044b\u0442\u043e\u043c.","reached_at":null,"title":""},"id":"605091","type":"goal"}],"links":{"self":"https://www.patreon.com/api/pledges/1"}}`
)

func TestVerifySignature(t *testing.T) {
	result, err := VerifySignature([]byte(pledgeCreateMessage), webhookSecret, "d339d4fa026a468919188cde6128b507")
	require.NoError(t, err)
	require.True(t, result)

	result, err = VerifySignature([]byte(pledgeCreateMessage), webhookSecret, "d339d4fa026a468919188cde6128b507-")
	require.NoError(t, err)
	require.False(t, result)
}
